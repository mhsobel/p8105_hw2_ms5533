---
title: "Homework 2"
author: "Marisa Sobel"
date: "9/28/2018"
output: github_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)

library(tidyverse)
library(readxl)
```

## Problem 1

* Read and clean data

* Retain: `line, station, name, station latitude/longidute, routes served, entry, vending, entrance type, ADA compliance`

* Convert `entry` from character to logical 

```{r, message=FALSE}
nyctransit_data = 
  read_csv("./data/NYC_Transit_Subway_Entrance_And_Exit_Data.csv") %>% 
  janitor::clean_names() %>% 
  select(line, starts_with("station"), starts_with("route"), entrance_type, 
         entry, vending, ada) %>% 
  mutate(entry = recode(entry, "YES" = TRUE, "NO" = FALSE))
nyctransit_data
```

### About `nyctransit_data`

The tibble created has 1,868 observations and 20 columns. It includes variables that describe the following: line (`line`), station name (`station_name`), station latitude (`station_latitude`), station longitude (`station_longitude`), station location as concatinated long/lat (`station_location`), entrance type (`entrance_type`), entry (`entry`), vending (`vending`), ADA compliance (`ada`), and all of the different route numbers. Most are variables with individual values except for the `route(#)` columns. This means that the data are not tidy, as there are missing values marked as "NA" in the `route(#)` columns. 

### Questions

1. How many distict stations are there? 

```{r}
distinct(nyctransit_data, line, station_name, .keep_all = FALSE)
```

There are **465 distinct stations**, identified by both station name and line. 

2. How many stations are ADA compliant? 

```{r}
filter(nyctransit_data, ada == TRUE)
```

**468 stations** are ADA compliant. 

3. What proportion of station entracnes/exits without vending allow entrence? 

```{r}
filter(nyctransit_data, vending == "NO") %>% 
  filter(entry == TRUE)
```

**69/183 stations** without vending allow entrance. 

### Reformat

Make route number and route name distinct variables. How many distinct stations serve the A train? Of stations that serve the A train, how many are ADA compliant? 

```{r}
nyctransit_data_tidy = gather(nyctransit_data, key = route_number,
                              value = route_name, route1:route11) %>% 
  filter(route_name == "A") %>% 
  distinct(line, station_name, .keep_all = TRUE) %>% 
  filter(ada == TRUE)
```

**60 distinct stations** serve the A train. **17** of those stations are ADA compliant. 


## Problem 2 

Read and clean `HealthyHarborWaterWheelTotals2017-9-26.xlsx`

* Specify the sheet in the Excel file and to omit columns containing notes (using the `range` argument and `cell_cols()` function)
* Use reasonable variable names
* Omit rows that do not include dumpster-specific data
* Rounds the number of sports balls to the nearest integer and converts the result to an integer variable (using `as.integer`)

```{r, message=FALSE}
trashwheel_data = 
  read_excel("./data/HealthyHarborWaterWheelTotals2017-9-26.xlsx", 
             sheet = "Mr. Trash Wheel", range = cell_cols("A:N")) %>% 
  janitor::clean_names() %>% 
  filter(!is.na(year)) %>% 
  mutate(sports_balls = as.integer(sports_balls))
```

Read and clean precipitation data for 2016 and 2017. 

* Omit rows without precipitation data and add a variable year

```{r, message=FALSE}
precip_2016 = 
  read_excel("./data/HealthyHarborWaterWheelTotals2017-9-26.xlsx", 
             sheet = "2016 Precipitation") %>% 
  janitor::clean_names() %>% 
  rename(month = precipitation_in, total = x_1) %>%
  filter(!is.na(month), !is.na(total),
         month != "Month", total != "Total") %>% 
  mutate(
    total = as.numeric(total),
    year = "2016")
precip_2016

precip_2017 = 
  read_excel("./data/HealthyHarborWaterWheelTotals2017-9-26.xlsx", 
             sheet = "2017 Precipitation") %>% 
  janitor::clean_names() %>% 
  rename(month = precipitation_in, total = x_1) %>% 
  filter(!is.na(month), !is.na(total), 
         month != "Month", total != "Total") %>% 
  mutate(
    total = as.numeric(total),
    year = "2017")
precip_2017
```

* Combine datasets and convert month to a character variable 

```{r, eval=FALSE}
precip_tidy = bind_rows(precip_2016, precip_2017) %>% 
  mutate(month = month.name(month)) 
```

### About `trashwheel_data` and `precip_tidy`


